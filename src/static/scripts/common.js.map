{"version":3,"sources":["common.js"],"names":["DOMAIN","API","SMART_ROUT_INFO","SEARCH_SMART_ROUT","SMART_ROUT","STATIC_ROUT_INFO","STATIC_ROUT","ALL_TYPE_INFO","ROUT","ACCOUNT_INFO","CHANNEL_INFO","CHANNEL_ITEM","QUERY_INFO_CHANGE","QUERY_ITEM_CHANNEL","QUERY_FEES_INFO","QUERY_FEE_ITEM","SAVE_CHANGE_INFO","DUMMY","WUI","init","options","config","system","locale","initSiteHeader","resp","SiteHeader","create","$el","$","name","aasUserPrincipal","ssoUserName","roles","aasUserResources","roleName","List","resources","filterMenus","menus","i","length","resource","resourceType","isLeaf","linkUrl","subs","push","findParent","result","parentLevelStructure","levelStructure","initSiteMenu","multiMenus","isHome","window","location","href","indexOf","menuResources","index","menuResource","parent","linkUr","isActive","newPage","address","level","split","j","sub","replaceWith","templates","initConfigInfo","initSiteFooter","getResource","url","a","la","pathname","_link","info","initSystem","data","ajax","method","done","userName","AdminLTE","ready","console","error","typeItem","list","map","item","codeType"],"mappings":"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","file":"common.js","sourcesContent":["var DOMAIN = '';\n\nvar API = {\n  SMART_ROUT_INFO: DOMAIN + '/upp/web/v1/routes', // 获取全部智能路由接口\n  SEARCH_SMART_ROUT: DOMAIN + '/upp/web/v1/feeRoute', //查询一条智能路由\n  SMART_ROUT: DOMAIN + '/upp/web/v1/route', //智能路由\n  STATIC_ROUT_INFO: DOMAIN + '/upp/web/v1/staticRoutes', // 获取全部静态路由接口\n  STATIC_ROUT: DOMAIN + '/upp/web/v1/staticRoute', //静态路由接口\n  ALL_TYPE_INFO: DOMAIN + '/upp/web/v1/allCodetables', //获取全部的类型接口\n  ROUT: DOMAIN + '/upp/web/v1/route', //路由\n  ACCOUNT_INFO: DOMAIN + '/upp/web/v1/accounts', //本方账户信息\n  CHANNEL_INFO: DOMAIN + '/upp/web/v1/channelAbilitys',//查询通道信息\n  CHANNEL_ITEM: DOMAIN + '/upp/web/v1/channelAbility',//查询单挑通道信息\n  QUERY_INFO_CHANGE: DOMAIN + '/upp/web/v1/uppTodos',//查询信息变更\n  QUERY_ITEM_CHANNEL: DOMAIN + '/upp/web/v1/maintainDetail', //查询单条通道信息\n  QUERY_FEES_INFO: DOMAIN + '/upp/web/v1/channelFees',//查询所有计费信息\n  QUERY_FEE_ITEM: DOMAIN + '/upp/web/v1/channelFee',//查询单个计费信息\n  SAVE_CHANGE_INFO: DOMAIN + '/upp/web/v1/uppTodo' //保存审核信息\n};\n\nAPI.DUMMY = '';\n\n//var WUI = window.WUI || {};\n\nWUI.init = function (options) {\n  // init global config\n  WUI.config = WUI.config || {};\n  WUI.config.system = options.system;\n  WUI.config.locale = options.locale || 'zh-CN';\n\n  var initSiteHeader = function (resp) {\n    WUI.SiteHeader.create({\n      $el: $('.main-header'),\n      name: resp.aasUserPrincipal.ssoUserName,\n      roles: resp.aasUserPrincipal.aasUserResources.roles[0].roleName,\n      List : resp.aasUserPrincipal.aasUserResources.resources\n    })\n  };\n\n  var filterMenus = function(resources) {\n    var menus = [];\n\n    for (var i = 0; i < resources.length; i++) {\n      var resource = resources[i];\n\n      if (resource.resourceType === 'menu') {\n        if (resource.isLeaf === '0') {\n          resource.linkUrl = 'javascript:void(0);';\n          resource.subs = [];\n        }\n        menus.push(resource);\n      }\n    }\n\n    return menus;\n  };\n\n  var findParent = function (resource, resources) {\n    var result = null;\n\n    if (resource.parentLevelStructure) {\n      for (var i = 0; i < resources.length; i++) {\n        if (resources[i].levelStructure === resource.parentLevelStructure) {\n          result = resources[i];\n          break;\n        }\n      }\n    }\n\n    return result;\n  }\n\n  var initSiteMenu = function (resp) {\n    var menus = [];\n    var multiMenus = false;\n    var resources = resp.aasUserPrincipal.aasUserResources.resources;\n    // 首页是为子系统单独添加的，没有放入后台做管理\n    var isHome = window.location.href.indexOf(WUI.config.system + '/home.html') >= 0;\n\n    if (WUI.config.system === 'order') {\n      // 工单系统四级菜单结构如：1.2.3.4.5 (第一位为子系统)\n      multiMenus = true;\n      var menuResources = filterMenus(resources);\n\n      for (var index = 0; index < menuResources.length; index++) {\n        var menuResource = menuResources[index];\n        var parent = findParent(menuResource, menuResources);\n\n        if (!isHome && window.location.href.indexOf(menuResource.linkUr) >= 0) {\n          menuResource.isActive = true;\n        }\n\n        if (parent) {\n          parent.subs.push(menuResource);\n        } else {\n          menus.push(menuResource);\n        }\n      }\n    } else {\n      // 统一系统二级菜单结构如：1.2.3 (第一位为子系统)\n      for (var i = 0; i < resources.length; i++) {\n        var resource = resources[i];\n        if (resource.linkUrl && resource.linkUrl.indexOf('trade-monitor') > 0) {\n          resource.newPage = true;\n        }\n        if (resource.resourceType === 'menu') {\n          var linkUrl = resource.linkUrl;\n          var address = window.location.href;\n\n          if (!isHome && address.indexOf(linkUrl) >= 0) {\n            resource.isActive = true;\n          }\n\n          var level = resource.levelStructure.split('.');\n\n          if (level[1] === '0') {\n            resource.subs = [];\n\n            for (var j = 0; j < resources.length; j++) {\n              var sub = resources[j];\n\n              if (sub.resourceType === 'menu' &&\n                sub.levelStructure.split('.')[0] === resource.levelStructure.split('.')[0]\n                && sub.levelStructure.split('.')[2] ==='0' &&\n                sub.levelStructure.split('.')[1] != '0'\n              ) {\n\n                sub.subs = [];\n                //for (var k = 0; k < resources.length; k++) {\n                //  var third = resources[k];\n                //  console.log('ss',third)\n                //  if (third.resourceType === 'menu' &&\n                //    third.parentLevelStructure === sub.levelStructure) {\n                //    sub.isLeaf = true;\n                //    sub.subs.push(third);\n                //  }\n                //}\n                // 兼容新菜单结构\n                sub.isLeaf = true;\n                resource.subs.push(sub);\n              }\n            }\n            menus.push(resource);\n          }\n        }\n      }\n    }\n\n    $('.main-sidebar').replaceWith(WUI.templates['site-menu']({\n      menus: menus,\n      isHome: isHome,\n      multiMenus: multiMenus\n    }));\n  };\n\n  var initConfigInfo = '';\n\n  var initSiteFooter = function (resp) {\n    $('.main-footer').replaceWith(WUI.templates['site-footer'](resp));\n  };\n\n  WUI.getResource = function (url, a) {\n    var la = a ? a : window.location.pathname;\n    url = la + url;\n    for (var i = 0; i < initConfigInfo.length; i++) {\n      var _link = initConfigInfo[i].linkUrl;\n      if (url == _link) {\n        var info = initConfigInfo[i];\n      }\n    }\n    return info\n  }\n\n  var initSystem = function () {\n    var url = '/' + WUI.config.system + '/web/v1/sso/getResources';\n    var data;\n\n    if (WUI.config.system === 'ams') {\n      url = '/ams/v1/sso/getResources';\n    } else if (WUI.config.system === 'order') {\n      // 工单系统获取菜单\n      url = '/app-coe-ordercenter/ordercenter/v1/sso/getResources';\n    }\n\n    WUI.ajax({\n      url: url,\n      method: 'POST',\n      data: data\n    }).done(function (resp) {\n      WUI.config.userName = resp.aasUserPrincipal.ssoUserName,\n        initSiteHeader(resp);\n      initSiteMenu(resp);\n      initSiteFooter(resp);\n      initConfigInfo = resp.aasUserPrincipal.aasUserResources.resources;\n      $.AdminLTE.init();\n      WUI.ready();\n    });\n  };\n\n  initSystem(options);\n};\n\nWUI.ready = WUI.ready || function () {\n    console.error('WUI: Please provide WUI.ready function.');\n  };\n\nWUI.typeItem = function (sub, info) {\n  var list = []\n  info.map(function (item) {\n    if (item.codeType == sub) {\n      list.push(item);\n    }\n  })\n  return list\n}\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJjb21tb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIERPTUFJTiA9ICcnO1xuXG52YXIgQVBJID0ge1xuICBTTUFSVF9ST1VUX0lORk86IERPTUFJTiArICcvdXBwL3dlYi92MS9yb3V0ZXMnLCAvLyDojrflj5blhajpg6jmmbrog73ot6/nlLHmjqXlj6NcbiAgU0VBUkNIX1NNQVJUX1JPVVQ6IERPTUFJTiArICcvdXBwL3dlYi92MS9mZWVSb3V0ZScsIC8v5p+l6K+i5LiA5p2h5pm66IO96Lev55SxXG4gIFNNQVJUX1JPVVQ6IERPTUFJTiArICcvdXBwL3dlYi92MS9yb3V0ZScsIC8v5pm66IO96Lev55SxXG4gIFNUQVRJQ19ST1VUX0lORk86IERPTUFJTiArICcvdXBwL3dlYi92MS9zdGF0aWNSb3V0ZXMnLCAvLyDojrflj5blhajpg6jpnZnmgIHot6/nlLHmjqXlj6NcbiAgU1RBVElDX1JPVVQ6IERPTUFJTiArICcvdXBwL3dlYi92MS9zdGF0aWNSb3V0ZScsIC8v6Z2Z5oCB6Lev55Sx5o6l5Y+jXG4gIEFMTF9UWVBFX0lORk86IERPTUFJTiArICcvdXBwL3dlYi92MS9hbGxDb2RldGFibGVzJywgLy/ojrflj5blhajpg6jnmoTnsbvlnovmjqXlj6NcbiAgUk9VVDogRE9NQUlOICsgJy91cHAvd2ViL3YxL3JvdXRlJywgLy/ot6/nlLFcbiAgQUNDT1VOVF9JTkZPOiBET01BSU4gKyAnL3VwcC93ZWIvdjEvYWNjb3VudHMnLCAvL+acrOaWuei0puaIt+S/oeaBr1xuICBDSEFOTkVMX0lORk86IERPTUFJTiArICcvdXBwL3dlYi92MS9jaGFubmVsQWJpbGl0eXMnLC8v5p+l6K+i6YCa6YGT5L+h5oGvXG4gIENIQU5ORUxfSVRFTTogRE9NQUlOICsgJy91cHAvd2ViL3YxL2NoYW5uZWxBYmlsaXR5JywvL+afpeivouWNleaMkemAmumBk+S/oeaBr1xuICBRVUVSWV9JTkZPX0NIQU5HRTogRE9NQUlOICsgJy91cHAvd2ViL3YxL3VwcFRvZG9zJywvL+afpeivouS/oeaBr+WPmOabtFxuICBRVUVSWV9JVEVNX0NIQU5ORUw6IERPTUFJTiArICcvdXBwL3dlYi92MS9tYWludGFpbkRldGFpbCcsIC8v5p+l6K+i5Y2V5p2h6YCa6YGT5L+h5oGvXG4gIFFVRVJZX0ZFRVNfSU5GTzogRE9NQUlOICsgJy91cHAvd2ViL3YxL2NoYW5uZWxGZWVzJywvL+afpeivouaJgOacieiuoei0ueS/oeaBr1xuICBRVUVSWV9GRUVfSVRFTTogRE9NQUlOICsgJy91cHAvd2ViL3YxL2NoYW5uZWxGZWUnLC8v5p+l6K+i5Y2V5Liq6K6h6LS55L+h5oGvXG4gIFNBVkVfQ0hBTkdFX0lORk86IERPTUFJTiArICcvdXBwL3dlYi92MS91cHBUb2RvJyAvL+S/neWtmOWuoeaguOS/oeaBr1xufTtcblxuQVBJLkRVTU1ZID0gJyc7XG5cbi8vdmFyIFdVSSA9IHdpbmRvdy5XVUkgfHwge307XG5cbldVSS5pbml0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgLy8gaW5pdCBnbG9iYWwgY29uZmlnXG4gIFdVSS5jb25maWcgPSBXVUkuY29uZmlnIHx8IHt9O1xuICBXVUkuY29uZmlnLnN5c3RlbSA9IG9wdGlvbnMuc3lzdGVtO1xuICBXVUkuY29uZmlnLmxvY2FsZSA9IG9wdGlvbnMubG9jYWxlIHx8ICd6aC1DTic7XG5cbiAgdmFyIGluaXRTaXRlSGVhZGVyID0gZnVuY3Rpb24gKHJlc3ApIHtcbiAgICBXVUkuU2l0ZUhlYWRlci5jcmVhdGUoe1xuICAgICAgJGVsOiAkKCcubWFpbi1oZWFkZXInKSxcbiAgICAgIG5hbWU6IHJlc3AuYWFzVXNlclByaW5jaXBhbC5zc29Vc2VyTmFtZSxcbiAgICAgIHJvbGVzOiByZXNwLmFhc1VzZXJQcmluY2lwYWwuYWFzVXNlclJlc291cmNlcy5yb2xlc1swXS5yb2xlTmFtZSxcbiAgICAgIExpc3QgOiByZXNwLmFhc1VzZXJQcmluY2lwYWwuYWFzVXNlclJlc291cmNlcy5yZXNvdXJjZXNcbiAgICB9KVxuICB9O1xuXG4gIHZhciBmaWx0ZXJNZW51cyA9IGZ1bmN0aW9uKHJlc291cmNlcykge1xuICAgIHZhciBtZW51cyA9IFtdO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNvdXJjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciByZXNvdXJjZSA9IHJlc291cmNlc1tpXTtcblxuICAgICAgaWYgKHJlc291cmNlLnJlc291cmNlVHlwZSA9PT0gJ21lbnUnKSB7XG4gICAgICAgIGlmIChyZXNvdXJjZS5pc0xlYWYgPT09ICcwJykge1xuICAgICAgICAgIHJlc291cmNlLmxpbmtVcmwgPSAnamF2YXNjcmlwdDp2b2lkKDApOyc7XG4gICAgICAgICAgcmVzb3VyY2Uuc3VicyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIG1lbnVzLnB1c2gocmVzb3VyY2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBtZW51cztcbiAgfTtcblxuICB2YXIgZmluZFBhcmVudCA9IGZ1bmN0aW9uIChyZXNvdXJjZSwgcmVzb3VyY2VzKSB7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG5cbiAgICBpZiAocmVzb3VyY2UucGFyZW50TGV2ZWxTdHJ1Y3R1cmUpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChyZXNvdXJjZXNbaV0ubGV2ZWxTdHJ1Y3R1cmUgPT09IHJlc291cmNlLnBhcmVudExldmVsU3RydWN0dXJlKSB7XG4gICAgICAgICAgcmVzdWx0ID0gcmVzb3VyY2VzW2ldO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHZhciBpbml0U2l0ZU1lbnUgPSBmdW5jdGlvbiAocmVzcCkge1xuICAgIHZhciBtZW51cyA9IFtdO1xuICAgIHZhciBtdWx0aU1lbnVzID0gZmFsc2U7XG4gICAgdmFyIHJlc291cmNlcyA9IHJlc3AuYWFzVXNlclByaW5jaXBhbC5hYXNVc2VyUmVzb3VyY2VzLnJlc291cmNlcztcbiAgICAvLyDpppbpobXmmK/kuLrlrZDns7vnu5/ljZXni6zmt7vliqDnmoTvvIzmsqHmnInmlL7lhaXlkI7lj7DlgZrnrqHnkIZcbiAgICB2YXIgaXNIb21lID0gd2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZihXVUkuY29uZmlnLnN5c3RlbSArICcvaG9tZS5odG1sJykgPj0gMDtcblxuICAgIGlmIChXVUkuY29uZmlnLnN5c3RlbSA9PT0gJ29yZGVyJykge1xuICAgICAgLy8g5bel5Y2V57O757uf5Zub57qn6I+c5Y2V57uT5p6E5aaC77yaMS4yLjMuNC41ICjnrKzkuIDkvY3kuLrlrZDns7vnu58pXG4gICAgICBtdWx0aU1lbnVzID0gdHJ1ZTtcbiAgICAgIHZhciBtZW51UmVzb3VyY2VzID0gZmlsdGVyTWVudXMocmVzb3VyY2VzKTtcblxuICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IG1lbnVSZXNvdXJjZXMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIHZhciBtZW51UmVzb3VyY2UgPSBtZW51UmVzb3VyY2VzW2luZGV4XTtcbiAgICAgICAgdmFyIHBhcmVudCA9IGZpbmRQYXJlbnQobWVudVJlc291cmNlLCBtZW51UmVzb3VyY2VzKTtcblxuICAgICAgICBpZiAoIWlzSG9tZSAmJiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKG1lbnVSZXNvdXJjZS5saW5rVXIpID49IDApIHtcbiAgICAgICAgICBtZW51UmVzb3VyY2UuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgIHBhcmVudC5zdWJzLnB1c2gobWVudVJlc291cmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtZW51cy5wdXNoKG1lbnVSZXNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8g57uf5LiA57O757uf5LqM57qn6I+c5Y2V57uT5p6E5aaC77yaMS4yLjMgKOesrOS4gOS9jeS4uuWtkOezu+e7nylcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciByZXNvdXJjZSA9IHJlc291cmNlc1tpXTtcbiAgICAgICAgaWYgKHJlc291cmNlLmxpbmtVcmwgJiYgcmVzb3VyY2UubGlua1VybC5pbmRleE9mKCd0cmFkZS1tb25pdG9yJykgPiAwKSB7XG4gICAgICAgICAgcmVzb3VyY2UubmV3UGFnZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc291cmNlLnJlc291cmNlVHlwZSA9PT0gJ21lbnUnKSB7XG4gICAgICAgICAgdmFyIGxpbmtVcmwgPSByZXNvdXJjZS5saW5rVXJsO1xuICAgICAgICAgIHZhciBhZGRyZXNzID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG5cbiAgICAgICAgICBpZiAoIWlzSG9tZSAmJiBhZGRyZXNzLmluZGV4T2YobGlua1VybCkgPj0gMCkge1xuICAgICAgICAgICAgcmVzb3VyY2UuaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBsZXZlbCA9IHJlc291cmNlLmxldmVsU3RydWN0dXJlLnNwbGl0KCcuJyk7XG5cbiAgICAgICAgICBpZiAobGV2ZWxbMV0gPT09ICcwJykge1xuICAgICAgICAgICAgcmVzb3VyY2Uuc3VicyA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJlc291cmNlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICB2YXIgc3ViID0gcmVzb3VyY2VzW2pdO1xuXG4gICAgICAgICAgICAgIGlmIChzdWIucmVzb3VyY2VUeXBlID09PSAnbWVudScgJiZcbiAgICAgICAgICAgICAgICBzdWIubGV2ZWxTdHJ1Y3R1cmUuc3BsaXQoJy4nKVswXSA9PT0gcmVzb3VyY2UubGV2ZWxTdHJ1Y3R1cmUuc3BsaXQoJy4nKVswXVxuICAgICAgICAgICAgICAgICYmIHN1Yi5sZXZlbFN0cnVjdHVyZS5zcGxpdCgnLicpWzJdID09PScwJyAmJlxuICAgICAgICAgICAgICAgIHN1Yi5sZXZlbFN0cnVjdHVyZS5zcGxpdCgnLicpWzFdICE9ICcwJ1xuICAgICAgICAgICAgICApIHtcblxuICAgICAgICAgICAgICAgIHN1Yi5zdWJzID0gW107XG4gICAgICAgICAgICAgICAgLy9mb3IgKHZhciBrID0gMDsgayA8IHJlc291cmNlcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgIC8vICB2YXIgdGhpcmQgPSByZXNvdXJjZXNba107XG4gICAgICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKCdzcycsdGhpcmQpXG4gICAgICAgICAgICAgICAgLy8gIGlmICh0aGlyZC5yZXNvdXJjZVR5cGUgPT09ICdtZW51JyAmJlxuICAgICAgICAgICAgICAgIC8vICAgIHRoaXJkLnBhcmVudExldmVsU3RydWN0dXJlID09PSBzdWIubGV2ZWxTdHJ1Y3R1cmUpIHtcbiAgICAgICAgICAgICAgICAvLyAgICBzdWIuaXNMZWFmID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyAgICBzdWIuc3Vicy5wdXNoKHRoaXJkKTtcbiAgICAgICAgICAgICAgICAvLyAgfVxuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgIC8vIOWFvOWuueaWsOiPnOWNlee7k+aehFxuICAgICAgICAgICAgICAgIHN1Yi5pc0xlYWYgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlc291cmNlLnN1YnMucHVzaChzdWIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtZW51cy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAkKCcubWFpbi1zaWRlYmFyJykucmVwbGFjZVdpdGgoV1VJLnRlbXBsYXRlc1snc2l0ZS1tZW51J10oe1xuICAgICAgbWVudXM6IG1lbnVzLFxuICAgICAgaXNIb21lOiBpc0hvbWUsXG4gICAgICBtdWx0aU1lbnVzOiBtdWx0aU1lbnVzXG4gICAgfSkpO1xuICB9O1xuXG4gIHZhciBpbml0Q29uZmlnSW5mbyA9ICcnO1xuXG4gIHZhciBpbml0U2l0ZUZvb3RlciA9IGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgJCgnLm1haW4tZm9vdGVyJykucmVwbGFjZVdpdGgoV1VJLnRlbXBsYXRlc1snc2l0ZS1mb290ZXInXShyZXNwKSk7XG4gIH07XG5cbiAgV1VJLmdldFJlc291cmNlID0gZnVuY3Rpb24gKHVybCwgYSkge1xuICAgIHZhciBsYSA9IGEgPyBhIDogd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuICAgIHVybCA9IGxhICsgdXJsO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5pdENvbmZpZ0luZm8ubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBfbGluayA9IGluaXRDb25maWdJbmZvW2ldLmxpbmtVcmw7XG4gICAgICBpZiAodXJsID09IF9saW5rKSB7XG4gICAgICAgIHZhciBpbmZvID0gaW5pdENvbmZpZ0luZm9baV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbmZvXG4gIH1cblxuICB2YXIgaW5pdFN5c3RlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdXJsID0gJy8nICsgV1VJLmNvbmZpZy5zeXN0ZW0gKyAnL3dlYi92MS9zc28vZ2V0UmVzb3VyY2VzJztcbiAgICB2YXIgZGF0YTtcblxuICAgIGlmIChXVUkuY29uZmlnLnN5c3RlbSA9PT0gJ2FtcycpIHtcbiAgICAgIHVybCA9ICcvYW1zL3YxL3Nzby9nZXRSZXNvdXJjZXMnO1xuICAgIH0gZWxzZSBpZiAoV1VJLmNvbmZpZy5zeXN0ZW0gPT09ICdvcmRlcicpIHtcbiAgICAgIC8vIOW3peWNleezu+e7n+iOt+WPluiPnOWNlVxuICAgICAgdXJsID0gJy9hcHAtY29lLW9yZGVyY2VudGVyL29yZGVyY2VudGVyL3YxL3Nzby9nZXRSZXNvdXJjZXMnO1xuICAgIH1cblxuICAgIFdVSS5hamF4KHtcbiAgICAgIHVybDogdXJsLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBkYXRhOiBkYXRhXG4gICAgfSkuZG9uZShmdW5jdGlvbiAocmVzcCkge1xuICAgICAgV1VJLmNvbmZpZy51c2VyTmFtZSA9IHJlc3AuYWFzVXNlclByaW5jaXBhbC5zc29Vc2VyTmFtZSxcbiAgICAgICAgaW5pdFNpdGVIZWFkZXIocmVzcCk7XG4gICAgICBpbml0U2l0ZU1lbnUocmVzcCk7XG4gICAgICBpbml0U2l0ZUZvb3RlcihyZXNwKTtcbiAgICAgIGluaXRDb25maWdJbmZvID0gcmVzcC5hYXNVc2VyUHJpbmNpcGFsLmFhc1VzZXJSZXNvdXJjZXMucmVzb3VyY2VzO1xuICAgICAgJC5BZG1pbkxURS5pbml0KCk7XG4gICAgICBXVUkucmVhZHkoKTtcbiAgICB9KTtcbiAgfTtcblxuICBpbml0U3lzdGVtKG9wdGlvbnMpO1xufTtcblxuV1VJLnJlYWR5ID0gV1VJLnJlYWR5IHx8IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zb2xlLmVycm9yKCdXVUk6IFBsZWFzZSBwcm92aWRlIFdVSS5yZWFkeSBmdW5jdGlvbi4nKTtcbiAgfTtcblxuV1VJLnR5cGVJdGVtID0gZnVuY3Rpb24gKHN1YiwgaW5mbykge1xuICB2YXIgbGlzdCA9IFtdXG4gIGluZm8ubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaWYgKGl0ZW0uY29kZVR5cGUgPT0gc3ViKSB7XG4gICAgICBsaXN0LnB1c2goaXRlbSk7XG4gICAgfVxuICB9KVxuICByZXR1cm4gbGlzdFxufVxuIl0sImZpbGUiOiJjb21tb24uanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==\n"],"sourceRoot":"/source/"}